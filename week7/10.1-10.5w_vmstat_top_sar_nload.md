### w命令查看当前系统的负载  
```
[root@61 ~]# w
 13:24:50 up 23:46,  2 users,  load average: 0.08, 0.03, 0.05
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
root     pts/0    10.148.60.71     13:20   10.00s  0.12s  0.05s vim 10.1-10.5w_vmstat_top_sar_nload.md
root     pts/1    10.148.60.71     13:24    1.00s  0.03s  0.00s w
```  

第一行从左面开始显示的信息依次为：时间，系统运行时间，登录用户数，平均负载。第二行开始以及下面所有的行，告诉我们的信息是，当前登录的都有哪些用户，以及他们是从哪里登录的等等。其中最重要的信息莫过于系统负载了，即第一行中的 ‘load average:’ 后面的三个数值。第一个数值表示1分钟内系统的平均负载值；第二个数值表示5分钟内系统的平均负载值；第三个数值表示15分钟系统的平均负载值。这个值的意义是，单位时间段内CPU活动进程数。当然这个值越大就说明你的服务器压力越大。一般情况下这个值只要不超过服务器的cpu数量就没有关系，如果服务器cpu数量为8，那么这个值若小于8，就说明当前服务器没有压力，否则就要关注一下了。那么，查看cpu个数的命令是：``` cat /proc/cpuinfo```查看proccesor的值。  
另外，uptime命令也可以查看系统的负载，和w得出的值是一样的。  
------------------------------------------------------------------------------------------
### vmstat命令监控系统状态  
```
[root@61 ~]# vmstat
procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----
 r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st
 0  0      0 3653516  15080 3977740    0    0     1    11    6    8  0  0 100  0  0
```  
w 查看的是系统整体上的负载，通过看那个数值可以知道当前系统有没有压力，但是具体是哪里（CPU, 内存，磁盘等）有压力就无法判断了。通过 vmstat 就可以知道具体是哪里有压力。vmstat命令打印的结果共分为6部分：procs, memory, swap, io, system, cpu. 请重点关注一下r b si so bi bo几列。  

1. procs 显示进程相关信息  

  r ：表示运行和等待cpu时间片的进程数，如果长期大于服务器cpu的个数，则说明cpu不够用了；  

  b ：表示等待资源的进程数，比如等待I/O, 内存等，这列的值如果长时间大于1，则需要关注一下了；  

2. memory 内存相关信息  

  swpd ：表示切换到交换分区中的内存数量 ；  

  free ：当前空闲的内存数量；  

  buff ：缓冲大小，（即将写入磁盘的）；  

  cache ：缓存大小，（从磁盘中读取的）；  

3. swap 内存交换情况  

  si ：由交换区写入到内存的数据量；  

  so ：由内存写入到交换区的数据量；  

4. io 磁盘使用情况

  bi ：从块设备读取数据的量（读磁盘）；  

  bo： 从块设备写入数据的量（写磁盘）；  

5. system 显示采集间隔内发生的中断次数  

  in ：表示在某一时间间隔中观测到的每秒设备中断数；  

  cs ：表示每秒产生的上下文切换次数；  

6. CPU 显示cpu的使用状态  

  us ：显示了用户下所花费 cpu 时间的百分比；  

  sy ：显示系统花费cpu时间百分比；  

  id ：表示cpu处于空闲状态的时间百分比；  

  wa ：表示I/O等待所占用cpu时间百分比；  

  st ：表示被偷走的cpu所占百分比（一般都为0，不用关注）；  

以上所介绍的各个参数中，要经常会关注r列，b列，和wa列，三列代表的含义在上边说得已经很清楚。IO部分的bi以及bo也是要经常参考的对象。如果磁盘io压力很大时，这两列的数值会比较高。另外当si, so两列的数值比较高，并且在不断变化时，说明内存不够了，内存中的数据频繁交换到交换分区中，这往往对系统性能影响极大。  

-----------------------------------------------------
### top命令动态查看系统负载  
```
top - 13:36:05 up 23:57,  2 users,  load average: 0.00, 0.01, 0.05
Tasks: 136 total,   1 running, 135 sleeping,   0 stopped,   0 zombie
%Cpu(s):  0.0 us,  0.1 sy,  0.0 ni, 99.9 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem :  7905528 total,  3652756 free,   259848 used,  3992924 buff/cache
KiB Swap:  8257532 total,  8257532 free,        0 used.  7311028 avail Mem 

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                    
    9 root      20   0       0      0      0 S   0.3  0.0   0:00.84 rcu_sched                                                  
 3632 root      20   0  148256   5596   4256 S   0.3  0.1   0:00.33 sshd                                                       
    1 root      20   0  191012   4008   2404 S   0.0  0.1   0:01.31 systemd                                                    
    2 root      20   0       0      0      0 S   0.0  0.0   0:00.00 kthreadd                                                   
    3 root      20   0       0      0      0 S   0.0  0.0   0:00.01 ksoftirqd/0                                                
    4 root      20   0       0      0      0 S   0.0  0.0   0:00.25 kworker/0:0                                                
    5 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kworker/0:0H                                               
    7 root      rt   0       0      0      0 S   0.0  0.0   0:00.01 migration/0                                                
    8 root      20   0       0      0      0 S   0.0  0.0   0:00.00 rcu_bh                                                     
   10 root      rt   0       0      0      0 S   0.0  0.0   0:00.18 watchdog/0 
```  
这个命令用于动态监控进程所占系统资源，每隔3秒变一次。这个命令的特点是把占用系统资源（CPU，内存，磁盘IO等）最高的进程放到最前面。top命令打印出了很多信息，包括系统负载（loadaverage）、进程数（Tasks）、cpu使用情况、内存使用情况以及交换分区使用情况。其实上面这些内容可以通过其他命令来查看，所以用top重点查看的还是下面的进程使用系统资源详细状况。这部分东西反映的东西还是比较多的，不过需要关注的也就是几项：%CPU, %MEM, COMMAND 分别表示cpu和内存的占比以及哪个命令在使用资源，RES 这一项为进程所占内存大小，而 %MEM 为使用内存百分比。在 top 状态下，按 “shift + m”, 可以按照内存使用大小排序。按数字 ‘1’ 可以列出各颗cpu的使用状态。  
*常用的一个命令``` top -bn1```它表示非动态打印系统资源使用情况，可以用在shell脚本中*  
---------------------------------------------------
### sar监控系统状态  

* 安装： ```yum -y install sysstat```  
* 查看网卡流量 ```sar -n DEV```  
  ```
  [root@61 ~]# sar -n DEV 1 2
  Linux 3.10.0-514.21.1.el7.x86_64 (61)   2017年07月10日  _x86_64_        (4 CPU)

  13时52分35秒     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s
  13时52分36秒        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00
  13时52分36秒    enp2s0      1.00      0.00      0.06      0.00      0.00      0.00      0.00

  13时52分36秒     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s
  13时52分37秒        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00
  13时52分37秒    enp2s0      1.00      2.00      0.06      0.52      0.00      0.00      0.00

  平均时间:     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s
  平均时间:        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00
  平均时间:    enp2s0      1.00      1.00      0.06      0.26      0.00      0.00      0.00
  ```  
  IFACE这列表示设备名称，rxpck/s 表示每秒进入收取的包的数量，txpck/s 表示每秒发送出去的包的数量，rxbyt/s 表示每秒收取的数据量（单位Byte），txbyt/s表示每秒发送的数据量。后面几列不需要关注。如果有一天你所管理的服务器丢包非常严重，那么你就应该看一看这个网卡流量是否异常了，如果rxpck/s 那一列的数值大于4000，或者rxbyt/s那列大于5,000,000则很有可能是被攻击了，正常的服务器网卡流量不会高于这么多，除非是你自己在拷贝数据。  
  上面命令查看的是实时流量，1代表每一秒刷新一次，一共查看两次。  

  *如果要查看某一天的网卡留余量，使用-f选项，后面跟文件名，即```sar -n DEV -f /var/log/sa29```，sa29表示日期29号，目录下还有一个sar29文件，这个文件是可以直接用cat来查看的，而sa29，只能用sar -f命令来查看*  

* 查看历史负载
  ```
  [root@61 ~]# sar -q
  Linux 3.10.0-514.21.1.el7.x86_64 (61)   2017年07月09日  _x86_64_        (4 CPU)

  00时00分01秒   runq-sz  plist-sz   ldavg-1   ldavg-5  ldavg-15
  00时10分01秒         0       142      0.00      0.00      0.00
  00时20分01秒         0       143      0.00      0.00      0.00
  00时30分01秒         0       143      0.00      0.01      0.00
  00时40分01秒         0       143      0.05      0.01      0.00
  00时50分01秒         0       143      0.00      0.00      0.00
  01时00分01秒         0       143      0.00      0.00      0.00
  01时10分01秒         0       143      0.08      0.03      0.00
  ```  
*这个命令比较复杂，主要学会用它来查看网卡流量*

----------------------------------------------------------------------------------
### nload命令监控网卡流量  
* 安装```yum -y install nload```  
  直接使用nload命令就可以实时查看当前网卡的流量，按方向键可以查看lo的流量  

  













